(function(b,a){var c=function(a,b,c){var d;return function(){var e=this,f=arguments;d?clearTimeout(d):c&&a.apply(e,f);d=setTimeout(function(){c||a.apply(e,f);d=null},b||100)}};jQuery.fn[a]=function(b){return b?this.bind("resize",c(b)):this.trigger(a)}})(jQuery,"smartresize");
var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");
function init_sidebar(){var b=function(){$RIGHT_COL.css("min-height",$(window).height());var a=$BODY.outerHeight(),b=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),d=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height();a=(a<d?d:a)-($NAV_MENU.height()+b);$RIGHT_COL.css("min-height",a)};$SIDEBAR_MENU.find("a").on("click",function(a){a=$(this).parent();a.is(".active")?(a.removeClass("active active-sm"),$("ul:first",a).slideUp(function(){b()})):(a.parent().is(".child_menu")?$BODY.is(".nav-sm")&&($SIDEBAR_MENU.find("li").removeClass("active active-sm"),
$SIDEBAR_MENU.find("li ul").slideUp()):($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),a.addClass("active"),$("ul:first",a).slideDown(function(){b()}))});$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm"));
$BODY.toggleClass("nav-md nav-sm");b()});$SIDEBAR_MENU.find('a[href="'+CURRENT_URL+'"]').parent("li").addClass("current-page");$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){b()}).parent().addClass("active");$(window).smartresize(function(){b()});b();$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}
$(document).ready(function(){$(".collapse-link").on("click",function(){var b=$(this).closest(".x_panel"),a=$(this).find("i"),c=b.find(".x_content");b.attr("style")?c.slideToggle(200,function(){b.removeAttr("style")}):(c.slideToggle(200),b.css("height","auto"));a.toggleClass("fa-chevron-up fa-chevron-down")});$(".close-link").click(function(){$(this).closest(".x_panel").remove()})});$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})});
$(".progress .progress-bar")[0]&&$(".progress .progress-bar").progressbar();$(document).ready(function(){$(".js-switch")[0]&&Array.prototype.slice.call(document.querySelectorAll(".js-switch")).forEach(function(b){new Switchery(b,{color:"#26B99A"})})});$("table input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$("table input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});
var checkState="";$(".bulk_action input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$(".bulk_action input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});$(".bulk_action input#check-all").on("ifChecked",function(){checkState="all";countChecked()});$(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none";countChecked()});
function countChecked(){"all"===checkState&&$(".bulk_action input[name='table_records']").iCheck("check");"none"===checkState&&$(".bulk_action input[name='table_records']").iCheck("uncheck");var b=$(".bulk_action input[name='table_records']:checked").length;b?($(".column-title").hide(),$(".bulk-actions").show(),$(".action-cnt").html(b+" Records Selected")):($(".column-title").show(),$(".bulk-actions").hide())}
$(document).ready(function(){$(".expand").on("click",function(){$(this).next().slideToggle(200);$expand=$(this).find(">:first-child");"+"==$expand.text()?$expand.text("-"):$expand.text("+")})});"undefined"!=typeof NProgress&&($(document).ready(function(){NProgress.start()}),$(window).load(function(){NProgress.done()}));var originalLeave=$.fn.popover.Constructor.prototype.leave;
$.fn.popover.Constructor.prototype.leave=function(b){var a=b instanceof this.constructor?b:$(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);originalLeave.call(this,b);if(b.currentTarget){var c=$(b.currentTarget).siblings(".popover");var d=a.timeout;c.one("mouseenter",function(){clearTimeout(d);c.one("mouseleave",function(){$.fn.popover.Constructor.prototype.leave.call(a,a)})})}};$("body").popover({selector:"[data-popover]",trigger:"click hover",delay:{show:50,hide:400}});
function init_DataTables(b){"undefined"!==typeof $.fn.DataTable&&(TableManageButtons=function(){return{init:function(){$("#datatable-buttons").length&&$("#datatable-buttons").DataTable({dom:"Bfrtip",buttons:[{extend:"copy",className:"btn-sm"},{extend:"csv",className:"btn-sm"},{extend:"excel",className:"btn-sm"},{extend:"pdfHtml5",className:"btn-sm"},{extend:"print",className:"btn-sm"}],responsive:!0})}}}(),$("#datatable").dataTable(),$("#datatable-keytable").DataTable({keys:!0}),$("#datatable-responsive").DataTable(),
$("#datatable-scroller").DataTable({deferRender:!0,scrollY:380,scrollCollapse:!0,scroller:!0}),JSON.stringify(b),dataSet=[["1","script-src",b["script-src"]],["2","base-uri",b["base-uri"]],["3","default-src",b["default-src"]],["4","object-src",b["object-src"]],["5","style-src",b["style-src"]],["6","img-src",b["img-src"]],["7","media-src",b["media-src"]],["8","frame-src",b["frame-src"]],["9","child-src",b["child-src"]],["10","frame-ancestors",b["frame-ancestors"]],["11","font-src",b["font-src"]],["12",
"connect-src",b["connect-src"]],["13","manifest-src",b["manifest-src"]],["14","form-action",b["form-action"]],["15","sandbox",b.sandbox],["16","script-nonce",b["script-nonce"]],["17","plugin-type",b["plugin-types"]],["18","reflected-xss",b["reflected-xss"]],["19","block-all-mixed-content",b["block-all-mixed-content"]],["20","upgrade-insecure-requests",b["upgrade-insecure-requests"]],["21","referrer",b.referrer],["22","report-uri",b["report-uri"]],["23","report-to",b["report-to"]]],$("#example").DataTable({data:dataSet}),
$("#datatable-fixed-header").DataTable({fixedHeader:!0}),b=$("#datatable-checkbox"),b.dataTable({order:[[1,"asc"]],columnDefs:[{orderable:!1,targets:[0]}]}),b.on("draw.dt",function(){$("checkbox input").iCheck({checkboxClass:"icheckbox_flat-green"})}),TableManageButtons.init())}
function init_echarts(){if("undefined"!==typeof echarts){var b={color:"#26B99A #34495E #BDC3C7 #3498DB #9B59B6 #8abb6f #759c6a #bfd3b7".split(" "),title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#408829"}},dataRange:{color:["#1f610a","#97b58d"]},toolbox:{color:["#408829","#408829","#408829","#408829"]},tooltip:{backgroundColor:"rgba(0,0,0,0.5)",axisPointer:{type:"line",lineStyle:{color:"#408829",type:"dashed"},crossStyle:{color:"#408829"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},dataZoom:{dataBackgroundColor:"#eee",
fillerColor:"rgba(64,136,41,0.2)",handleColor:"#408829"},grid:{borderWidth:0},categoryAxis:{axisLine:{lineStyle:{color:"#408829"}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#408829"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},timeline:{lineStyle:{color:"#408829"},controlStyle:{normal:{color:"#408829"},emphasis:{color:"#408829"}}},k:{itemStyle:{normal:{color:"#68a54a",color0:"#a9cba2",
lineStyle:{width:1,color:"#408829",color0:"#86b379"}}}},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#c12e34"}}},emphasis:{areaStyle:{color:"#99d2dd"},label:{textStyle:{color:"#c12e34"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#408829"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},
chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#86b379"],[.8,"#68a54a"],[1,"#408829"]],width:8}},axisTick:{splitNumber:10,length:12,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{length:18,lineStyle:{color:"auto"}},pointer:{length:"90%",color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"Arial, Verdana, sans-serif"}};$("#mainb").length&&
$.ajax({url:"/api/public-key-pins",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("pkp_total");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(a.total));echarts.init(document.getElementById("mainb"),b).setOption({title:{text:"",subtext:""},tooltip:{trigger:"axis"},legend:{data:["pin-sha256","max-age","includeSubDomains","report-uri"]},toolbox:{show:!1},calculable:!1,xAxis:[{type:"category",data:[""]}],yAxis:[{type:"value"}],
series:[{name:"pin-sha256",type:"bar",data:[a["pin-sha256"]]},{name:"max-age",type:"bar",data:[a["max-age"]]},{name:"includeSubDomains",type:"bar",data:[a.includeSubDomains]},{name:"report-uri",type:"bar",data:[a["report-uri"]]}]})},error:function(a){console.log(a)}});$("#echart_sonar").length&&$.ajax({url:"/api/x-xss-protection",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("xss_total");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(a.total));
echarts.init(document.getElementById("echart_sonar"),b).setOption({title:{text:"",subtext:""},tooltip:{trigger:"item"},legend:{orient:"vertical",x:"right",y:"bottom",data:[""]},toolbox:{show:!0,feature:{restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save Image"}}},polar:[{indicator:[{text:"0",max:10838},{text:"0; mode=block",max:10838},{text:"1",max:a["1"]},{text:"1; mode=block",max:10838},{text:"report",max:10838},{text:"other",max:10838}]}],calculable:!0,series:[{name:"",type:"radar",
data:[{value:[a["0"],a["0-mode-block"],a["1"],a["1-mode-block"],a.report,a.other],name:""}]}]})},error:function(a){console.log(a)}});$("#xfo").length&&$.ajax({url:"/api/x-frame-options",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("xfo_total");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(a.total));echarts.init(document.getElementById("xfo"),b).setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},
legend:{x:"center",y:"bottom",data:["deny","sameorigin","allow-from <uri>","other"]},toolbox:{show:!0,feature:{magicType:{show:!0,type:["pie","funnel"]},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save Image"}}},calculable:!0,series:[{name:"x-frame-options",type:"pie",radius:[25,90],center:["50%",170],roseType:"area",x:"50%",max:40,sort:"ascending",data:[{value:a.deny,name:"deny"},{value:a.sameorigin,name:"sameorigin"},{value:a["allow-from"],name:"allow-from <uri>"},{value:a.other,
name:"other"}]}]})},error:function(a){console.log(a)}});$("#sites_scannned").length&&$.ajax({url:"/api/total",data:$("form").serialize(),type:"GET",success:function(a){document.getElementById("sites_scannned").innerHTML=a.total},error:function(a){console.log(a)}});$("#xcto_donut").length&&$.ajax({url:"/api/x-content-type-options",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("xcto_total");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(a.total));
echarts.init(document.getElementById("xcto_donut"),b).setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},calculable:!0,legend:{x:"center",y:"bottom",data:["nosniff","other"]},toolbox:{show:!0,feature:{magicType:{show:!0,type:["pie","funnel"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"center",max:1548}}},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save Image"}}},series:[{name:"x-content-type-options",type:"pie",radius:["35%","55%"],itemStyle:{normal:{label:{show:!0},
labelLine:{show:!0}},emphasis:{label:{show:!0,position:"center",textStyle:{fontSize:"14",fontWeight:"normal"}}}},data:[{value:a.nosniff,name:"nosniff"},{value:a.other,name:"other"}]}]})},error:function(a){console.log(a)}});$("#referrer_policy_total").length&&$.ajax({url:"/api/referrer-policy",data:$("form").serialize(),type:"GET",success:function(a){for(var b=document.getElementById("referrer_policy_total");b.firstChild;)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(a.total))}});
$("#x_permitted_cross_domain_policies_total").length&&$.ajax({url:"/api/x-permitted-cross-domain-policies",data:$("form").serialize(),type:"GET",success:function(a){for(var b=document.getElementById("x_permitted_cross_domain_policies_total");b.firstChild;)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(a.total))}});$("#echart_pie").length&&$.ajax({url:"/api/strict-transport-security",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("sts_total");c.firstChild;)c.removeChild(c.firstChild);
c.appendChild(document.createTextNode(a.total));echarts.init(document.getElementById("echart_pie"),b).setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{x:"center",y:"bottom",data:["max-age","includeSubDomains"]},toolbox:{show:!0,feature:{magicType:{show:!0,type:["pie","funnel"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"left",max:140}}},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save Image"}}},calculable:!0,series:[{name:"header option:",type:"pie",
radius:"55%",center:["50%","48%"],data:[{value:a["max-age"],name:"max-age"},{value:a.includeSubDomains,name:"includeSubDomains"}]}]})},error:function(a){console.log(a)}});$("#echart_line").length&&$.ajax({url:"/api/content-security-policy",data:$("form").serialize(),type:"GET",success:function(a){for(var c=document.getElementById("csp_total");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(a.total));init_DataTables(a);echarts.init(document.getElementById("echart_line"),
b).setOption({title:{text:"",subtext:""},tooltip:{trigger:"axis"},legend:{x:220,y:40,data:["analysis"]},toolbox:{show:!0,feature:{magicType:{show:!0,title:{bar:"Bar"},type:["bar"]},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save Image"}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:"script-src base-uri default-src object-src style-src img-src media-src frame-src child-src frame-ancestors font-src connect-src manifest-src form-action sandbox script-nonce plugin-types reflected-xss block-all-mixed-content upgrade-insecure-requests referrer report-uri report-to".split(" ")}],
yAxis:[{type:"value"}],series:[{name:"analysis",type:"bar",smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:[a["script-src"],a["base-uri"],a["default-src"],a["object-src"],a["style-src"],a["img-src"],a["media-src"],a["frame-src"],a["child-src"],a["frame-ancestors"],a["font-src"],a["connect-src"],a["manifest-src"],a["form-action"],a.sandbox,a["script-nonce"],a["plugin-types"],a["reflected-xss"],a["block-all-mixed-content"],a["upgrade-insecure-requests"],a.referrer,a["report-uri"],a["report-to"]]}]})},
error:function(a){console.log(a)}})}}$(document).ready(function(){init_sidebar();init_echarts()});